import{c as $,j as s,u,s as L,T as f,B as b,y as A,z as B,A as I,r as d,L as P,f as C}from"./index-eaf8ef63.js";import{T as y}from"./Tabs-2aacb86a.js";import{I as _}from"./IconTrash-44b73a37.js";import{G as w}from"./Grid-cdc18556.js";import{F as D}from"./Flex-7df226c6.js";import{A as E}from"./AppShell-8727aab5.js";import{H as z}from"./Header-fe453f52.js";import{N as F}from"./Navbar-fd359ea9.js";var H=$("plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]]);const M=({tabOptions:i=[],setCurrentTab:o})=>{var l;const t=e=>{const r=i.find(x=>x.name===e);o(r)};return s.jsx("div",{className:"header",children:s.jsx(y,{onTabChange:e=>{t(e)},radius:"0px",defaultValue:(l=i[0])==null?void 0:l.name,sx:{".mantine-Tabs-tabsList":{border:"none",borderColor:"none"}},children:s.jsx(y.List,{children:i==null?void 0:i.map((e,r)=>s.jsx(y.Tab,{value:e.name,children:e.label},r))})})})},R=({total:i,products:o,handleBuy:t,handleRemove:l})=>{const{lang:e}=u(L);return s.jsxs("div",{className:"cart-container",children:[s.jsx("span",{className:"cart-header",children:s.jsx(f,{order:3,children:e.dark_market.shopping_cart})}),s.jsx("div",{className:"cart-list",children:o.map((r,x)=>s.jsxs("div",{className:"cart-product",children:[s.jsx(f,{order:6,children:s.jsx("li",{children:`${r.amount}x ${r.label} - $${r.price*r.amount}`})}),s.jsx(_,{size:18,style:{marginTop:"2px"},onClick:()=>{l(r)}})]},x))}),s.jsxs("div",{className:"cart-footer",children:[s.jsx(f,{order:4,children:`${e.dark_market.total} $${i}`}),s.jsx(b,{sx:{marginLeft:"20px"},onClick:t,disabled:!o[0],children:e.dark_market.buy})]})]})},G=({currentTab:i,handleAdd:o})=>{var l;const{inventoryPath:t}=u(A);return s.jsx("div",{className:"products-container",children:s.jsx("div",{className:"products-list",children:s.jsx(w,{columns:3,children:(l=i==null?void 0:i.items)==null?void 0:l.map(e=>s.jsxs(w.Col,{className:"product-card",children:[s.jsx("span",{className:"product-header",children:s.jsx(f,{order:4,children:e==null?void 0:e.label})}),s.jsx(B,{height:100,width:100,mx:"auto",radius:"md",src:t?`${`https://cfx-nui-${t}${e==null?void 0:e.name}.png`}`:`blackmarket/${e==null?void 0:e.name}.png`,alt:e==null?void 0:e.name,sx:{marginTop:"10px",backgroundColor:"transparent"},withPlaceholder:!0}),s.jsxs("span",{className:"product-footer",children:[s.jsxs(D,{justify:"flex-start",align:"flex-end",direction:"column",wrap:"wrap-reverse",children:[s.jsxs(f,{order:6,children:[s.jsx("a",{children:"Price:"})," ",s.jsx("a",{style:{fontWeight:"400"},children:`${e==null?void 0:e.price} ${e==null?void 0:e.accountLabel}`})]}),s.jsxs(f,{order:6,children:[s.jsx("a",{children:"Stock:"})," ",s.jsx("a",{style:{fontWeight:"400"},children:e==null?void 0:e.stock})]})]}),s.jsx(I,{sx:{display:"inline-flex",backgroundColor:"#1971C2",":hover":{backgroundColor:"#1C7ED6"}},onClick:()=>{o(e)},disabled:(e==null?void 0:e.stock)<=0,children:s.jsx(H,{size:"1.125rem"})})]})]}))})})})};const Y=()=>{const[i,o]=d.useState([]),[t,l]=d.useState([]),[e,r]=d.useState([]),[x,p]=d.useState(!0),[g,j]=d.useState(0),N=a=>{const c=a.name;if(e.find(h=>h.name===c)){const h=e.map(n=>{if(n.name===c){const k=n.amount+1;return j(g+a.price),{...n,amount:k}}return n}),m=t.items.map(n=>{if(n.name===c){const k=n.stock-1;return{...n,stock:k}}return n});r(h),l({...t,items:m})}else{const h=t.items.map(m=>{if(m.name===c){const n=m.stock-1;return{...m,stock:n}}return m});j(g+a.price),r([...e,{name:c,label:a.label,price:a.price,amount:1,account:a.account,category:t.name}]),l({...t,items:h})}},T=async()=>{await C("av_blackmarket","handleBuy",e)=="ok"&&(r([]),j(0))},S=a=>{if(e.find(v=>v.name===a.name)){const v=e.filter(n=>n.name!==a.name),h=a.price*a.amount,m=t.items.map(n=>{if(n.name===a.name){const k=n.stock+a.amount;return{...n,stock:k}}return n});l({...t,items:m}),r(v),j(g-h)}};return d.useEffect(()=>{(async()=>{const c=await C("av_blackmarket","fetchData");c[0]&&(o(c),l(c[0])),setTimeout(()=>{p(!1)},500)})()},[]),s.jsx(s.Fragment,{children:x?s.jsx("div",{style:{position:"absolute",width:"100%",height:"100%"},children:s.jsx(P,{visible:x,overlayBlur:2,overlayColor:"rgba(20, 21, 23, 1)"})}):s.jsx(E,{header:s.jsx(z,{height:70,children:s.jsx(M,{tabOptions:i,setCurrentTab:l})}),navbar:s.jsx(F,{width:{base:250},height:"100%",fixed:!1,withBorder:!1,children:s.jsx(R,{total:g,products:e,handleBuy:T,handleRemove:S})}),styles:a=>({main:{backgroundColor:a.colorScheme==="dark"?a.colors.dark[8]:a.colors.gray[0],padding:"10px",marginTop:"75px"}}),sx:{marginTop:"-40px"},children:s.jsx(G,{currentTab:t,handleAdd:N})})})};export{Y as default};
